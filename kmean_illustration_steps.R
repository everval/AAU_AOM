#setwd("/Users/edward/Documents/Dropbox/The One With What I'm Working On/Teaching/2017/Clusters/Codes")

rm(list=ls())
graphics.off()

source("funs_clusters.R")

K = 2
ps = 1
pd = 3

limx = 2

#Generate data
set.seed(17)
x=matrix(rnorm (100*2), ncol=2)
plot(x,col=4, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
invisible(readline(prompt="Press [enter] to continue"))

#Initial clusters (randomnly assigned)
ind_0 = sample(K,100,replace=T)
plot(x,col=ind_0, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
invisible(readline(prompt="Press [enter] to continue"))

#Find centroids
C_0 = get_cent(x,ind_0,K)
plot(x,col=ind_0, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
invisible(readline(prompt="Press [enter] to continue"))

#Find closest centroids, assign new clusters
ind_1 = calc_cent(x,C_0)
plot(x,col=ind_1, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
invisible(readline(prompt="Press [enter] to continue"))

#Find centroids
C_1 = get_cent(x,ind_1,K)
plot(x,col=ind_1, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
invisible(readline(prompt="Press [enter] to continue"))


ind_2 = calc_cent(x,C_1); C_2 = get_cent(x,ind_2,K)
plot(x,col=ind_2, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
points(C_2,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
lines(c(C_1[1,1],C_2[1,1]),c(C_1[1,2],C_2[1,2]),col=1,lwd=2)
lines(c(C_1[2,1],C_2[2,1]),c(C_1[2,2],C_2[2,2]),col=2,lwd=2)
invisible(readline(prompt="Press [enter] to continue"))
# 
ind_3 = calc_cent(x,C_2); C_3 = get_cent(x,ind_3,K)
plot(x,col=ind_3, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
points(C_2,col=c(1,2),pch=20,cex=pd)
points(C_3,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
lines(c(C_1[1,1],C_2[1,1]),c(C_1[1,2],C_2[1,2]),col=1,lwd=2)
lines(c(C_1[2,1],C_2[2,1]),c(C_1[2,2],C_2[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
invisible(readline(prompt="Press [enter] to continue"))

ind_4 = calc_cent(x,C_3); C_4 = get_cent(x,ind_4,K)
plot(x,col=ind_4, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
points(C_2,col=c(1,2),pch=20,cex=pd)
points(C_3,col=c(1,2),pch=20,cex=pd)
points(C_4,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
lines(c(C_1[1,1],C_2[1,1]),c(C_1[1,2],C_2[1,2]),col=1,lwd=2)
lines(c(C_1[2,1],C_2[2,1]),c(C_1[2,2],C_2[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
invisible(readline(prompt="Press [enter] to continue"))

ind = calc_cent(x,C_4); C_5 = get_cent(x,ind,K)
plot(x,col=ind, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
points(C_2,col=c(1,2),pch=20,cex=pd)
points(C_3,col=c(1,2),pch=20,cex=pd)
points(C_4,col=c(1,2),pch=20,cex=pd)
points(C_5,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
lines(c(C_1[1,1],C_2[1,1]),c(C_1[1,2],C_2[1,2]),col=1,lwd=2)
lines(c(C_1[2,1],C_2[2,1]),c(C_1[2,2],C_2[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
lines(c(C_4[2,1],C_5[2,1]),c(C_4[2,2],C_5[2,2]),col=2,lwd=2)
lines(c(C_4[2,1],C_5[2,1]),c(C_4[2,2],C_5[2,2]),col=2,lwd=2)
invisible(readline(prompt="Press [enter] to continue"))

ind = calc_cent(x,C_5); C_6 = get_cent(x,ind,K)
plot(x,col=ind, pch =1, cex =ps,xlim=c(-limx,limx),ylim=c(-limx,limx))
points(C_0,col=c(1,2),pch=20,cex=pd)
points(C_1,col=c(1,2),pch=20,cex=pd)
points(C_2,col=c(1,2),pch=20,cex=pd)
points(C_3,col=c(1,2),pch=20,cex=pd)
points(C_4,col=c(1,2),pch=20,cex=pd)
points(C_5,col=c(1,2),pch=20,cex=pd)
points(C_6,col=c(1,2),pch=20,cex=pd)
lines(c(C_0[1,1],C_1[1,1]),c(C_0[1,2],C_1[1,2]),col=1,lwd=2)
lines(c(C_0[2,1],C_1[2,1]),c(C_0[2,2],C_1[2,2]),col=2,lwd=2)
lines(c(C_1[1,1],C_2[1,1]),c(C_1[1,2],C_2[1,2]),col=1,lwd=2)
lines(c(C_1[2,1],C_2[2,1]),c(C_1[2,2],C_2[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_2[2,1],C_3[2,1]),c(C_2[2,2],C_3[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
lines(c(C_3[2,1],C_4[2,1]),c(C_3[2,2],C_4[2,2]),col=2,lwd=2)
lines(c(C_4[2,1],C_5[2,1]),c(C_4[2,2],C_5[2,2]),col=2,lwd=2)
lines(c(C_4[2,1],C_5[2,1]),c(C_4[2,2],C_5[2,2]),col=2,lwd=2)
lines(c(C_5[2,1],C_6[2,1]),c(C_5[2,2],C_6[2,2]),col=2,lwd=2)
lines(c(C_5[2,1],C_6[2,1]),c(C_5[2,2],C_6[2,2]),col=2,lwd=2)